{"ast":null,"code":"import { createCipheriv, createDecipheriv, randomBytes, createHash } from 'crypto';\n\nclass PaytmChecksum {\n  static encrypt(input, key) {\n    var cipher = createCipheriv('AES-128-CBC', key, PaytmChecksum.iv);\n    var encrypted = cipher.update(input, 'binary', 'base64');\n    encrypted += cipher.final('base64');\n    return encrypted;\n  }\n\n  static decrypt(encrypted, key) {\n    var decipher = createDecipheriv('AES-128-CBC', key, PaytmChecksum.iv);\n    var decrypted = decipher.update(encrypted, 'base64', 'binary');\n\n    try {\n      decrypted += decipher.final('binary');\n    } catch (e) {\n      console.log(e);\n    }\n\n    return decrypted;\n  }\n\n  static generateSignature(params, key) {\n    if (typeof params !== \"object\" && typeof params !== \"string\") {\n      var error = \"string or object expected, \" + typeof params + \" given.\";\n      return Promise.reject(error);\n    }\n\n    if (typeof params !== \"string\") {\n      params = PaytmChecksum.getStringByParams(params);\n    }\n\n    return PaytmChecksum.generateSignatureByString(params, key);\n  }\n\n  static verifySignature(params, key, checksum) {\n    if (typeof params !== \"object\" && typeof params !== \"string\") {\n      var error = \"string or object expected, \" + typeof params + \" given.\";\n      return Promise.reject(error);\n    }\n\n    if (params.hasOwnProperty(\"CHECKSUMHASH\")) {\n      delete params.CHECKSUMHASH;\n    }\n\n    if (typeof params !== \"string\") {\n      params = PaytmChecksum.getStringByParams(params);\n    }\n\n    return PaytmChecksum.verifySignatureByString(params, key, checksum);\n  }\n\n  static async generateSignatureByString(params, key) {\n    var salt = await PaytmChecksum.generateRandomString(4);\n    return PaytmChecksum.calculateChecksum(params, key, salt);\n  }\n\n  static verifySignatureByString(params, key, checksum) {\n    var paytm_hash = PaytmChecksum.decrypt(checksum, key);\n    var salt = paytm_hash.substr(paytm_hash.length - 4);\n    return paytm_hash === PaytmChecksum.calculateHash(params, salt);\n  }\n\n  static generateRandomString(length) {\n    return new Promise(function (resolve, reject) {\n      randomBytes(length * 3.0 / 4.0, function (err, buf) {\n        if (!err) {\n          var salt = buf.toString(\"base64\");\n          resolve(salt);\n        } else {\n          console.log(\"error occurred in generateRandomString: \" + err);\n          reject(err);\n        }\n      });\n    });\n  }\n\n  static getStringByParams(params) {\n    var data = {};\n    Object.keys(params).sort().forEach(function (key, value) {\n      data[key] = params[key] !== null && params[key].toLowerCase() !== \"null\" ? params[key] : \"\";\n    });\n    return Object.values(data).join('|');\n  }\n\n  static calculateHash(params, salt) {\n    var finalString = params + \"|\" + salt;\n    return createHash('sha256').update(finalString).digest('hex') + salt;\n  }\n\n  static calculateChecksum(params, key, salt) {\n    var hashString = PaytmChecksum.calculateHash(params, salt);\n    return PaytmChecksum.encrypt(hashString, key);\n  }\n\n}\n\nPaytmChecksum.iv = '@@@@&&&&####$$$$';\nexport default PaytmChecksum;","map":{"version":3,"names":["createCipheriv","createDecipheriv","randomBytes","createHash","PaytmChecksum","encrypt","input","key","cipher","iv","encrypted","update","final","decrypt","decipher","decrypted","e","console","log","generateSignature","params","error","Promise","reject","getStringByParams","generateSignatureByString","verifySignature","checksum","hasOwnProperty","CHECKSUMHASH","verifySignatureByString","salt","generateRandomString","calculateChecksum","paytm_hash","substr","length","calculateHash","resolve","err","buf","toString","data","Object","keys","sort","forEach","value","toLowerCase","values","join","finalString","digest","hashString"],"sources":["C:/Users/Rushikesh/Downloads/shop-cart/shop-cart/src/components/paytmChecksum.js"],"sourcesContent":["import { createCipheriv, createDecipheriv, randomBytes, createHash } from 'crypto';\n\nclass PaytmChecksum {\n\n\tstatic encrypt(input, key) {\n\t\tvar cipher = createCipheriv('AES-128-CBC', key, PaytmChecksum.iv);\n\t\tvar encrypted = cipher.update(input, 'binary', 'base64');\n\t\tencrypted += cipher.final('base64');\n\t\treturn encrypted;\n\t}\n\tstatic decrypt(encrypted, key) {\n\t\tvar decipher = createDecipheriv('AES-128-CBC', key, PaytmChecksum.iv);\n\t\tvar decrypted = decipher.update(encrypted, 'base64', 'binary');\n\t\ttry {\n\t\t\tdecrypted += decipher.final('binary');\n\t\t}\n\t\tcatch (e) {\n\t\t\tconsole.log(e);\n\t\t}\n\t\treturn decrypted;\n\t}\n\tstatic generateSignature(params, key) {\n\t\tif (typeof params !== \"object\" && typeof params !== \"string\") {\n\t\t\tvar error = \"string or object expected, \" + (typeof params) + \" given.\";\n\t\t\treturn Promise.reject(error);\n\t\t}\n\t\tif (typeof params !== \"string\") {\n\t\t\tparams = PaytmChecksum.getStringByParams(params);\n\t\t}\n\t\treturn PaytmChecksum.generateSignatureByString(params, key);\n\t}\n\n\n\tstatic verifySignature(params, key, checksum) {\n\t\tif (typeof params !== \"object\" && typeof params !== \"string\") {\n\t\t\tvar error = \"string or object expected, \" + (typeof params) + \" given.\";\n\t\t\treturn Promise.reject(error);\n\t\t}\n\t\tif (params.hasOwnProperty(\"CHECKSUMHASH\")) {\n\t\t\tdelete params.CHECKSUMHASH\n\t\t}\n\t\tif (typeof params !== \"string\") {\n\t\t\tparams = PaytmChecksum.getStringByParams(params);\n\t\t}\n\t\treturn PaytmChecksum.verifySignatureByString(params, key, checksum);\n\t}\n\n\tstatic async generateSignatureByString(params, key) {\n\t\tvar salt = await PaytmChecksum.generateRandomString(4);\n\t\treturn PaytmChecksum.calculateChecksum(params, key, salt);\n\t}\n\n\tstatic verifySignatureByString(params, key, checksum) {\n\t\tvar paytm_hash = PaytmChecksum.decrypt(checksum, key);\n\t\tvar salt = paytm_hash.substr(paytm_hash.length - 4);\n\t\treturn (paytm_hash === PaytmChecksum.calculateHash(params, salt));\n\t}\n\n\tstatic generateRandomString(length) {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\trandomBytes((length * 3.0) / 4.0, function (err, buf) {\n\t\t\t\tif (!err) {\n\t\t\t\t\tvar salt = buf.toString(\"base64\");\n\t\t\t\t\tresolve(salt);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tconsole.log(\"error occurred in generateRandomString: \" + err);\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic getStringByParams(params) {\n\t\tvar data = {};\n\t\tObject.keys(params).sort().forEach(function (key, value) {\n\t\t\tdata[key] = (params[key] !== null && params[key].toLowerCase() !== \"null\") ? params[key] : \"\";\n\t\t});\n\t\treturn Object.values(data).join('|');\n\t}\n\n\tstatic calculateHash(params, salt) {\n\t\tvar finalString = params + \"|\" + salt;\n\t\treturn createHash('sha256').update(finalString).digest('hex') + salt;\n\t}\n\tstatic calculateChecksum(params, key, salt) {\n\t\tvar hashString = PaytmChecksum.calculateHash(params, salt);\n\t\treturn PaytmChecksum.encrypt(hashString, key);\n\t}\n}\nPaytmChecksum.iv = '@@@@&&&&####$$$$';\nexport default PaytmChecksum;"],"mappings":"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"},"metadata":{},"sourceType":"module"}